Last login: Mon Sep 22 15:49:56 2025 from 176.88.74.220
root@srv:~# # =============================================================================
# BEYAZ TİCARET VPS KURULUMU - HATASIZ VERSİYON
# =============================================================================

# 1️⃣ SISTEM HAZIRLIĞI
echo "🚀 Sistem güncelleniyor..."
apt update && apt upgrade -y

# Node.js 20 kurulumu
echo "📦 Node.js kuruluyor..."
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs build-essential

# PM2 ve Nginx
echo "⚙️ PM2 ve Nginx kuruluyor..."
npm install -g pm2
apt install -y nginx

# 2️⃣ POSTGRESQL AYARLARI
echo "🗄️ PostgreSQL ayarları yapılıyor..."
sudo -u postgres psql << 'EOF'
\c beyazticaret_db;
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
\q
EOF

# 3️⃣ PROJE KLASÖRÜ AYARLARI
echo "📁 Proje klasörü hazırlanıyor..."
cd /home/enderouttlet/web/enderouttlet.com/public_html/node/BeyazTicaretV1

echo "🎉 BEYAZTİCARET SİTESİ HAZIR!"^Cull && echo "✅ Localhost bağlantısı OK" || echo "❌ Localhost bağlantısı HATA"
root@srv:~# cd /home/enderouttlet/web/enderouttlet.com/public_html/node/BeyazTicaretV1
root@srv:/home/enderouttlet/web/enderouttlet.com/public_html/node/BeyazTicaretV1# # =============================================================================
# BEYAZ TİCARET VPS KURULUMU - HATASIZ VERSİYON
# =============================================================================

# 1️⃣ SISTEM HAZIRLIĞI
echo "🚀 Sistem güncelleniyor..."
apt update && apt upgrade -y

# Node.js 20 kurulumu
echo "📦 Node.js kuruluyor..."
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs build-essential

# PM2 ve Nginx
echo "⚙️ PM2 ve Nginx kuruluyor..."
npm install -g pm2
apt install -y nginx

# 2️⃣ POSTGRESQL AYARLARI
echo "🗄️ PostgreSQL ayarları yapılıyor..."
sudo -u postgres psql << 'EOF'
\c beyazticaret_db;
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
\q
EOF

# 3️⃣ PROJE KLASÖRÜ AYARLARI
echo "📁 Proje klasörü hazırlanıyor..."
echo "🎉 BEYAZTİCARET SİTESİ HAZIR!"/null && echo "✅ Localhost bağlantısı OK" || echo "❌ Localhost bağlantısı HATA"
🚀 Sistem güncelleniyor...
E: Conflicting values set for option Signed-By regarding source https://deb.nodesource.com/node_20.x/ nodistro: /usr/share/keyrings/nodejs.gpg != /usr/share/keyrings/nodesource.gpg
E: The list of sources could not be read.
📦 Node.js kuruluyor...
2025-09-22 15:53:40 - Installing pre-requisites
E: Conflicting values set for option Signed-By regarding source https://deb.nodesource.com/node_20.x/ nodistro: /usr/share/keyrings/nodejs.gpg != /usr/share/keyrings/nodesource.gpg
E: The list of sources could not be read.
2025-09-22 15:53:40 - Error: Failed to run 'apt-get update' (Exit Code: 0)
E: Conflicting values set for option Signed-By regarding source https://deb.nodesource.com/node_20.x/ nodistro: /usr/share/keyrings/nodejs.gpg != /usr/share/keyrings/nodesource.gpg
E: The list of sources could not be read.
⚙️ PM2 ve Nginx kuruluyor...

changed 133 packages in 9s

13 packages are looking for funding
  run `npm fund` for details
E: Conflicting values set for option Signed-By regarding source https://deb.nodesource.com/node_20.x/ nodistro: /usr/share/keyrings/nodejs.gpg != /usr/share/keyrings/nodesource.gpg
E: The list of sources could not be read.
🗄️ PostgreSQL ayarları yapılıyor...
You are now connected to database "beyazticaret_db" as user "postgres".
CREATE EXTENSION
📁 Proje klasörü hazırlanıyor...
🔧 Environment variables ayarlanıyor...
📦 Dependencies kuruluyor...
npm error code EUSAGE
npm error
npm error `npm ci` can only install packages when your package.json and package-lock.json or npm-shrinkwrap.json are in sync. Please update your lock file with `npm install` before continuing.
npm error
npm error Missing: pm2@5.4.3 from lock file
npm error Missing: @pm2/agent@2.0.4 from lock file
npm error Missing: @pm2/io@6.0.1 from lock file
npm error Missing: @pm2/js-api@0.8.0 from lock file
npm error Missing: @pm2/pm2-version-check@1.0.4 from lock file
npm error Missing: async@3.2.6 from lock file
npm error Missing: blessed@0.1.81 from lock file
npm error Missing: chalk@3.0.0 from lock file
npm error Missing: cli-tableau@2.0.1 from lock file
npm error Missing: commander@2.15.1 from lock file
npm error Missing: croner@4.1.97 from lock file
npm error Missing: dayjs@1.11.18 from lock file
npm error Missing: enquirer@2.3.6 from lock file
npm error Missing: eventemitter2@5.0.1 from lock file
npm error Missing: fclone@1.0.11 from lock file
npm error Missing: js-yaml@4.1.0 from lock file
npm error Missing: mkdirp@1.0.4 from lock file
npm error Missing: needle@2.4.0 from lock file
npm error Missing: pidusage@3.0.2 from lock file
npm error Missing: pm2-axon@4.0.1 from lock file
npm error Missing: pm2-axon-rpc@0.7.1 from lock file
npm error Missing: pm2-deploy@1.0.2 from lock file
npm error Missing: pm2-multimeter@0.1.2 from lock file
npm error Missing: pm2-sysmonit@1.2.8 from lock file
npm error Missing: promptly@2.2.0 from lock file
npm error Missing: semver@7.7.2 from lock file
npm error Missing: sprintf-js@1.1.2 from lock file
npm error Missing: vizion@2.2.1 from lock file
npm error Missing: dayjs@1.8.36 from lock file
npm error Missing: fast-json-patch@3.1.1 from lock file
npm error Missing: nssocket@0.6.0 from lock file
npm error Missing: proxy-agent@6.3.1 from lock file
npm error Missing: semver@7.5.4 from lock file
npm error Missing: ws@7.5.10 from lock file
npm error Missing: async@2.6.4 from lock file
npm error Missing: eventemitter2@6.4.9 from lock file
npm error Missing: require-in-the-middle@5.2.0 from lock file
npm error Missing: semver@7.5.4 from lock file
npm error Missing: shimmer@1.2.1 from lock file
npm error Missing: signal-exit@3.0.7 from lock file
npm error Missing: tslib@1.9.3 from lock file
npm error Missing: async@2.6.4 from lock file
npm error Missing: eventemitter2@6.4.9 from lock file
npm error Missing: extrareqp2@1.0.0 from lock file
npm error Missing: ws@7.5.10 from lock file
npm error Missing: ansi-styles@4.3.0 from lock file
npm error Missing: supports-color@7.2.0 from lock file
npm error Missing: ansi-colors@4.1.3 from lock file
npm error Missing: argparse@2.0.1 from lock file
npm error Missing: debug@3.2.7 from lock file
npm error Missing: sax@1.4.1 from lock file
npm error Missing: eventemitter2@0.4.14 from lock file
npm error Missing: lazy@1.0.11 from lock file
npm error Missing: amp@0.3.1 from lock file
npm error Missing: amp-message@0.1.2 from lock file
npm error Missing: escape-string-regexp@4.0.0 from lock file
npm error Missing: run-series@1.1.9 from lock file
npm error Missing: tv4@1.3.0 from lock file
npm error Missing: charm@0.1.2 from lock file
npm error Missing: pidusage@2.0.21 from lock file
npm error Missing: systeminformation@5.27.10 from lock file
npm error Missing: tx2@1.0.5 from lock file
npm error Missing: read@1.0.7 from lock file
npm error Missing: http-proxy-agent@7.0.2 from lock file
npm error Missing: lru-cache@7.18.3 from lock file
npm error Missing: pac-proxy-agent@7.2.0 from lock file
npm error Missing: socks-proxy-agent@8.0.5 from lock file
npm error Missing: @tootallnate/quickjs-emscripten@0.23.0 from lock file
npm error Missing: get-uri@6.0.5 from lock file
npm error Missing: http-proxy-agent@7.0.2 from lock file
npm error Missing: pac-resolver@7.0.1 from lock file
npm error Missing: basic-ftp@5.0.5 from lock file
npm error Missing: data-uri-to-buffer@6.0.2 from lock file
npm error Missing: degenerator@5.0.1 from lock file
npm error Missing: netmask@2.0.2 from lock file
npm error Missing: ast-types@0.13.4 from lock file
npm error Missing: escodegen@2.1.0 from lock file
npm error Missing: esprima@4.0.1 from lock file
npm error Missing: estraverse@5.3.0 from lock file
npm error Missing: esutils@2.0.3 from lock file
npm error Missing: mute-stream@0.0.8 from lock file
npm error Missing: module-details-from-path@1.0.4 from lock file
npm error Missing: socks@2.8.7 from lock file
npm error Missing: smart-buffer@4.2.0 from lock file
npm error Missing: has-flag@4.0.0 from lock file
npm error Missing: json-stringify-safe@5.0.1 from lock file
npm error Missing: async@2.6.4 from lock file
npm error Missing: git-node-fs@1.0.0 from lock file
npm error Missing: ini@1.3.8 from lock file
npm error Missing: js-git@0.7.8 from lock file
npm error Missing: bodec@0.1.0 from lock file
npm error Missing: culvert@0.1.2 from lock file
npm error Missing: git-sha1@0.1.2 from lock file
npm error Missing: pako@0.2.9 from lock file
npm error Missing: lru-cache@6.0.0 from lock file
npm error Missing: yallist@4.0.0 from lock file
npm error Missing: lru-cache@6.0.0 from lock file
npm error Missing: yallist@4.0.0 from lock file
npm error
npm error Clean install a project
npm error
npm error Usage:
npm error npm ci
npm error
npm error Options:
npm error [--install-strategy <hoisted|nested|shallow|linked>] [--legacy-bundling]
npm error [--global-style] [--omit <dev|optional|peer> [--omit <dev|optional|peer> ...]]
npm error [--include <prod|dev|optional|peer> [--include <prod|dev|optional|peer> ...]]
npm error [--strict-peer-deps] [--foreground-scripts] [--ignore-scripts] [--no-audit]
npm error [--no-bin-links] [--no-fund] [--dry-run]
npm error [-w|--workspace <workspace-name> [-w|--workspace <workspace-name> ...]]
npm error [-ws|--workspaces] [--include-workspace-root] [--install-links]
npm error
npm error aliases: clean-install, ic, install-clean, isntall-clean
npm error
npm error Run "npm help ci" for more info
npm error A complete log of this run can be found in: /root/.npm/_logs/2025-09-22T15_53_50_221Z-debug-0.log
🔨 Frontend build yapılıyor...

> rest-express@1.0.0 build
> vite build

sh: 1: vite: not found
🗄️ Database tabloları oluşturuluyor...

> rest-express@1.0.0 db:push
> drizzle-kit push

sh: 1: drizzle-kit: not found
🌐 Nginx ayarlanıyor...
-bash: /etc/nginx/sites-available/enderouttlet.com: No such file or directory
ln: failed to create symbolic link '/etc/nginx/sites-enabled/': No such file or directory
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
🚀 Site başlatılıyor...

> rest-express@1.0.0 start:prod
> NODE_ENV=production pm2 start server/index.ts --name arcelik-ecommerce --instances max --max-memory-restart 1G --interpreter tsx

[PM2] Spawning PM2 daemon with pm2_home=/root/.pm2
[PM2] PM2 Successfully daemonized
[PM2][ERROR] Interpreter tsx is NOT AVAILABLE in PATH. (type 'which tsx' to double check.)
[PM2] Saving current process list...
[PM2][WARN] PM2 is not managing any process, skipping save...
[PM2][WARN] To force saving use: pm2 save --force
[PM2] Init System found: systemd
Platform systemd
Template
[Unit]
Description=PM2 process manager
Documentation=https://pm2.keymetrics.io/
After=network.target

[Service]
Type=forking
User=root
LimitNOFILE=infinity
LimitNPROC=infinity
LimitCORE=infinity
Environment=PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/hestia/bin:/root/.local/bin:/root/.local/bin:/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
Environment=PM2_HOME=/root/.pm2
PIDFile=/root/.pm2/pm2.pid
Restart=on-failure

ExecStart=/usr/lib/node_modules/pm2/bin/pm2 resurrect
ExecReload=/usr/lib/node_modules/pm2/bin/pm2 reload all
ExecStop=/usr/lib/node_modules/pm2/bin/pm2 kill

[Install]
WantedBy=multi-user.target

Target path
/etc/systemd/system/pm2-root.service
Command list
[ 'systemctl enable pm2-root' ]
[PM2] Writing init configuration in /etc/systemd/system/pm2-root.service
[PM2] Making script booting at startup...
[PM2] [-] Executing: systemctl enable pm2-root...
[PM2] [v] Command successfully executed.
+---------------------------------------+
[PM2] Freeze a process list on reboot via:
$ pm2 save

[PM2] Remove init script via:
$ pm2 unstartup systemd

✅ ============================================
✅         KURULUM TAMAMLANDI!
✅ ============================================

🌐 Site Adresleri:
   - Domain: http://enderouttlet.com
   - IP: http://84.201.5.238

📊 Kontrol Komutları:
   - pm2 status                 (Site durumu)
   - pm2 logs arcelik-ecommerce (Loglar)
   - pm2 restart arcelik-ecommerce (Yeniden başlat)

🔍 Bağlantı testi yapılıyor...
✅ Localhost bağlantısı OK

🎉 BEYAZTİCARET SİTESİ HAZIR!